<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xmlns:aop="http://www.springframework.org/schema/aop"
	   xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

   <bean id="sessionFactory" class="org.springframework.orm.hibernate5.LocalSessionFactoryBean">
   	<property name="configLocations">
   		<value>classpath:hibernate.cfg.xml</value>
   	</property>
  </bean>
   <bean id="applicationContext"
        class="org.apache.axis2.extensions.spring.receivers.ApplicationContextHolder"/>
        
 <bean id="hibernateTemplate" class="org.springframework.orm.hibernate5.HibernateTemplate">
    <property name="sessionFactory" ref="sessionFactory"></property>
</bean>
 
 <!-- activemq 配置 -->
 
 
<bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate">  
        <!-- 这个connectionFactory对应的是我们定义的Spring提供的那个ConnectionFactory对象 -->  
        <property name="connectionFactory" ref="connectionFactory"/>  
    </bean>  
      
    <!-- 真正可以产生Connection的ConnectionFactory，由对应的 JMS服务厂商提供-->  
    <bean id="targetConnectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory">  
        <property name="brokerURL" value="tcp://localhost:61616"/>  
    </bean>  
      
    <!-- Spring用于管理真正的ConnectionFactory的ConnectionFactory -->  
    <bean id="connectionFactory" class="org.springframework.jms.connection.SingleConnectionFactory">  
        <!-- 目标ConnectionFactory对应真实的可以产生JMS Connection的ConnectionFactory -->  
        <property name="targetConnectionFactory" ref="targetConnectionFactory"/>  
    </bean>  
      
    <!--这个是队列目的地-->  
    <bean id="queueDestination" class="org.apache.activemq.command.ActiveMQQueue">  
        <constructor-arg>  
            <value>queue</value>  
        </constructor-arg>  
    </bean>  
    <!-- 消息监听器 -->  
    <bean id="consumerMessageListener" class="com.huoyushi.jms.ConsumerMessageListener"/>  
    <!-- 消息监听容器 -->  
    
    <bean id="jmsContainer"  
        class="org.springframework.jms.listener.DefaultMessageListenerContainer">  
        <property name="connectionFactory" ref="connectionFactory" />  
        <property name="destination" ref="queueDestination" />  
        <property name="messageListener" ref="consumerMessageListener" />  
    </bean>  

 <bean id="Producer" class="com.huoyushi.jms.Producer">  
        <!-- 消息生产者-->  
        <property name="jmsTemplate" ref="jmsTemplate"/>
 </bean> 
 
  <bean id="TestDAO"
        class="daoTest.TestDAO">
        <property name="hibernateTemplate">
            <ref local="hibernateTemplate" />
        </property>
  </bean>
  

   <bean id="TestService"
        class="com.axis2.service.TestService">
        <property name="testDAO">
            <ref local="TestDAO" />
        </property>
         <property name="producer">
            <ref local="Producer" />
        </property>
         <property name="destination">
            <ref local="queueDestination"/>
        </property>
  </bean>
  <bean id="TestService2"
        class="com.axis2.service.TestService2">
        <property name="testDAO">
            <ref local="TestDAO" />
        </property>
  </bean>

</beans>